---
id: 8cf2c2a1-a833-48f5-93d8-928fb316ee76
title: React
desc: ''
updated: 1612379944290
created: 1611082314842
parent: 1eeab78a-4075-44c1-8316-d0d35922857a
children: []
fname: computer-science.lang.javascript.react
hpath: computer-science.lang.javascript.react
---
# React

## Preparation

Two Questions

1. What is React? 
2. What problem does React solve? 

- Look at Approach #1 (DOM Focused) 
- Look at Approach #2 (Data / Declarative view)

react ==reacts== to changes in your JS and reload just what has changed making the App faster, reactive and performant

* * *

## Basic React

A React component is a function, written a normal or ES6 function:

```javascript
const App=()=> return(
    <>
    <OurHeader />
       <TimeArea />
       <Small />
    </>
)

const OurHeader=()=> <h1 className="special">Our amazing app header</h1>
const TimeArea =()=><p>The current time is {new Date().toLocaleString()}.</p>
const Small = () => <small>Copyright Footer Text</small>

// React.render(what, where)
setInterval(()=>ReactDOM.render( <OurApp/>,document.querySelector("#app")),1000);
```

## Props

 In React we cannot only use attributes such as: href, src,id,class etc. but as well properties or "props"

```javascript {.line-numbers}
 const OurApp = () =>{
 return (
     <>
     <OurHeader />
     <TimeArea />
     <ul>
         <Pet name="Meowalot" species="cat" age="5" />
         <Pet name="Barksalot" species="dog" age="2" />
         <Pet name="Fluffy" species="rubbit" age="3" />
     </ul>
     <Small />
     </>
 )
 }

 const OurHeader=()=> <h1 className="special">Our amazing app header</h1>
 const TimeArea =()=><p>The current time is {new Date().toLocaleString()}.</p>
 const Small =()=> <small>Copyright Footer Text</small>
 const Pet=(props)=> <li>`{props.name} is a {props.species} and is a {props.age} years old.`</li>

 setInterval(()=>ReactDOM.render( <OurApp/>,document.querySelector("#app")),1000);
```

and with some [destructuring assignment](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment), an ES6 feature:

```javascript {.line-numbers highlight=19}
const OurApp = () =>{
   return (
     <>
       <OurHeader />
       <TimeArea />
       <ul>
         <Pet name="Meowalot" species="cat" age="5" />
         <Pet name="Barksalot" species="dog" age="2" />
         <Pet name="Fluffy" species="rubbit" age="3" />
       </ul>
       <Small />
     </>
   )
}

const OurHeader=()=> <h1 className="special">Our amazing app header</h1>
const TimeArea =()=><p>The current time is {new Date().toLocaleString()}.</p>
const Small =()=> <small>Copyright Footer Text</small>
const Pet=({name,species,age})=> <li>`{name} is a {species} and is a {age} years old.`</li>
// Above here the destructuring assignment

setInterval(()=>ReactDOM.render( <OurApp/>,document.querySelector("#app")),1000);
```

  ![](/dendron-template/assets/images/2021-01-19-19-11-42.png)

## Loop through collection in JSX

```javascript {.line-numbers highlight=15}
const pets = [
  { name: "Meowsalot", species: "cat", age: "5", id: 123456789 },
  { name: "Barksalot", species: "dog", age: "3", id: 987654321 },
  { name: "Fluffy", species: "rabbit", age: "2", id: 123123123 },
  { name: "Purrsloud", species: "cat", age: "1", id: 456456456 },
  { name: "Paws", species: "dog", age: "6", id: 789789789 }
]

const OurApp = () =>{
   return (
     <>
       <OurHeader />
       <TimeArea />
       <ul>
         {pets.map( pet=><Pet name={pet.name} species={pet.species} age={pet.age} key={pet.id} /> )}
       </ul>
       <Small />
     </>
   )
}

const OurHeader=()=> <h1 className="special">Our amazing app header</h1>
const TimeArea =()=><p>The current time is {new Date().toLocaleString()}.</p>
const Small =()=> <small>Copyright Footer Text</small>
const Pet=({name,species,age})=> <li>`{name} is a {species} and is a {age} years old.`</li>

setInterval(()=>ReactDOM.render( <OurApp/>,document.querySelector("#app")),1000);
```

## State

What is state?
The time value in the snippet is a state component: this means that is going to change based on something (the function `new date()` ) and re-load.
How do we start working with state data?

Check the comments in the code snippets

```javascript {.line-numbers highlight=15}
// Below we declare the pointer to the React object that has a propertiy called useState to manage state.
const useState = React.useState;

const pets = [
  { name: "Meowsalot", species: "cat", age: "5", id: 123456789 },
  { name: "Barksalot", species: "dog", age: "3", id: 987654321 },
  { name: "Fluffy", species: "rabbit", age: "2", id: 123123123 },
  { name: "Purrsloud", species: "cat", age: "1", id: 456456456 },
  { name: "Paws", species: "dog", age: "6", id: 789789789 }
]

const OurApp = () =>{
   return (
     <>
       <OurHeader />
       <TimeArea />
       <ul>
         {pets.map( pet=><Pet name={pet.name} species={pet.species} age={pet.age} key={pet.id} /> )}
       </ul>
       <Small />
     </>
   )
}

const OurHeader=()=> <h1 className="special">Our amazing app header</h1>
const TimeArea =()=>{
  // set useState initial value and is returning an array with 2 items: [ how we can access the value, function to how we can update the value]
 const [theTime,setTheTime] = useState(new Date().toLocaleString()) 
 // then we set the timeout function
 setTimeout( () => setTheTime(new Date().toLocaleString()),1000)
 return <p>The current time is {theTime}.</p>
}
const Small =()=> <small>Copyright Footer Text</small>
const Pet=({name,species,age})=> <li>`{name} is a {species} and is a {age} years old.`</li>

ReactDOM.render( <OurApp/>,document.querySelector("#app"));
```

* * *

## Handling events

ex. Respond to a user event using `state` that re-render the part of the UI that has changed

```javascript
const LikeArea = ()=>{
  const [likeCount,setLikeCount]=useState(0) // initial value for the counter + destructuring the array of values
  const increaseLikeHandler=()=>setLikeCount( prev => prev +=1)
  const decreaseLikeHandler=()=>setLikeCount( prev => prev > 0 ? prev -=1 : 0)
  
  return(
    <>
      <button onClick={increaseLikeHandler}> Increase likes</button>
      <button onClick={decreaseLikeHandler}> Decrease likes</button>
      <h2>This page has been like {likeCount} times.</h2>
      </>
  )
}
```

  Don't mutate the State, you want React handle things from there

* * *

## useEffect to create persistency in data in the context of React

Can be used twice:

```javascript
// Only run once the first time this component is rendered
useEffect( ()=> {
  // for instance 
 if (localStorage.getItem('exampleData')){
   setArraydata(JSON.parse(localStorage.getItem('exampleData'))) // function that let set update the state in the component
 }
}, [])
// run every time our pet state changes ... and save it to the local Storage, for instance
useEffect(()=>{
  localStorage.setItem('exampleData',JSON.stringify(array))
}, [array])
```

Using localStorage from the browser and useEffect in React

* * *

## Prepare to start a project

Checklist

- [ ] Node is installed 

- [ ] run `npm init -y` 

- [ ] to run `npm install react react-dom` 

- [ ] to run React in the browser install _webpack_ from npm 

- [ ] to run `npm install webpack webpack-cli webpack-dev-server`

- [ ] create a file in the root folder _webpack.config.js_ and add this configutation code:
  ```javascript
  const path = require("path")
    module.exports = {
      entry: "./app/Main.js",
      output: {
        publicPath: "/",
        path: path.resolve(__dirname, "app"),
        filename: "bundled.js"
      },
      mode: "development",
      devtool: "source-map",
      devServer: {
        port: 3000,
        contentBase: path.join(__dirname, "app"),
        hot: true,
        historyApiFallback: { index: "index.html" }
      },
      module: {
        rules: [
          {
            test: /\.js$/,
            exclude: /(node_modules)/,
            use: {
              loader: "babel-loader",
              options: {
                presets: ["@babel/preset-react", ["@babel/preset-env", { targets: { node: "12" } }]]
              }
            }
          }
        ]
      }
    }
  ```

- [ ] to run:  `npm install @babel/core @babel/preset-env @babel/preset-react babel-loader`

- [ ] add this to package.json: 
  ````javascript
  "scripts": {
    "dev":"webpack serve",
    "test": "echo \"Error: no test specified\" && exit 1"
  }, ```
  ````

- [ ] `npm run dev`  

- [ ] under `React.render(...|)` add: `if (module.hot) {module.hot.accept()}`

* * *

## Move between pages

Client-side routing

- [ ] run in terminal: `npm install react-router-dom` or `npm i react-router-dom`
- [ ] import in the main App JS adding: `import {BrowserRouter, Switch, Route } from 'react-router-dom'`

We are not using server-side routing so we cannot use traditional html tag and its attribute `<a href="">`;
In React become `<Link to="">` tag; and where we want to use them we need to import: `import {Link} from 'react-router-dom'`

## Created Container and Page components in order to sue Composition over Inheritance and avoid to reuse the same code in different places.

- Use of `{props.children}` inside Parent component to show children content component.

## Setup a backend

Signup for a free account on MongoDB.com...Atlas

create a collection:

- DB name: ...
- collection:...

then Connect -> add a IP Address (whitelisted and temporarly) 0.0.0.0/0

2021-01-28 18:43

## Login / logout

Building components with different logic: 

- headerLoggedOut

```javascript {.line-numbers highlight=5-6}
import React, { useEffect,useState } from "react"
import Axios from 'axios'

function HeaderLoggedOut() {
  const [username,setUsername] = useState()
  const [password,setPassword] = useState()

  async function handleSubmit(e) {
    e.preventDefault()
    try {
    const response = await Axios.post('http://localhost:8080/login', { username, password })
    // console.log(response.data)
    response.data ? console.log(response.data) : console.log('Incorrect username / password')
    } catch(e) {
    console.log('There was a problem.')
    }   
  }
  return (
    <form onSubmit={handleSubmit} className="mb-0 pt-2 pt-md-0">
          <div className="row align-items-center">
            <div className="col-md mr-0 pr-md-0 mb-3 mb-md-0">
              <input onChange={e => setUsername(e.target.value) } name="username" className="form-control form-control-sm input-dark" type="text" placeholder="Username" autoComplete="off" />
            </div>
            <div className="col-md mr-0 pr-md-0 mb-3 mb-md-0">
              <input onChange={e => setPassword(e.target.value)} name="password" className="form-control form-control-sm input-dark" type="password" placeholder="Password" />
            </div>
            <div className="col-md-auto">
              <button className="btn btn-success btn-sm">Sign In</button>
            </div>
          </div>
        </form>
  )
}
export default HeaderLoggedOut
```

* * *

2021-01-29 19:45

#### Managing states that reside in another part of the UI

From Header to Main component... **I need to left the state up** and then passing them down as `props` as it 's necessary.

* * *

2021-01-30 16:32

Default axios URL:
`Axios.defaults.baseURL = 'http://localhost:8080/'` into the main file and then use Axios only with th `/link-path` 

* * *

2021-01-31 15:39

To use `React router` to use history and redirect after succesfully create a post to the post itself, we need to:

```javascript
// at the top
import {withRouter} from 'react-router-dom'

// code block

// at the bottom
export default withRouter(CreatePost)
```

* * *

2021-02-01 16:35

### `context`

==EASY TO SHARE DATA THROUGH THE ENTIRE APPLICATION==
[Official Doc: `context`](https://reactjs.org/docs/context.html)
Which problem is solving?

- It solves what is it called **component drilling**, we pass a component as a container:
  `<ExampleContext.Provider value={addFlashMessage}>` around our component and then we can pass the value to any child component no matters how level deep they are!
- How can we consume this value from a child component?
  In the chid component :

1. In case there was a props, cut it out! We don't need the props: `addFlashMessage={addFlashMessage}`

2. in the child component:

- at the top:
  `import React, { useEffect,useState, useContext } from "react"`
  `import ExampleContext from "../ExampleContext"`
- In the component:
  - `const addFlashMessage = useContext(ExampleContext)`

* * *

### `useReducer`

==TO KEEP ALL THE LOGIC IN ONE CENTRALLY LOCATED PLACE==
[Official Doc: `useReducer`](https://reactjs.org/docs/hooks-reference.html#usereducer)
Is preferable to useState when you have complex state logic
`const [state,dispatch] = useReducer()` : the state and what is used to update state...
the `dispatch({...})` is going to be pass into the reducer function...i.e. `ourReducer(state, action){...}`
check React documentation to get more clarification

* * *

### Using useReducer and Context

This is not optimal:
`<ExampleContext.Provider value={{ state, dispatch }}>`

We need to set 2 Context.Provider:

### Immer

==MAKE VERY EASY TO WORK WITH COMPLEX OBJECTS IN IMMUTABLE FASHION==
Improving usage of `state` via Immer:
`npm i immer use-immer`
and import where needed: `import {useImmerReducer} from 'use-immer'
` basically use as replacement for React useReducer function
and change from: `const [state,dispatch] = useReducer(ourReducer, initialState)` to `const [state,dispatch] = useImmerReducer(ourReducer, initialState)`

Basically Immer give us a draft copy of the state and then we can use it and modify it as much as we like.

